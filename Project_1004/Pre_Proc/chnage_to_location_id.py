import pandas as pd 
import numpy as np 



#location_ID = np.array([[0.0, 0.0], [40.712783700000003, -74.005941299999989], [40.605663200000002, -73.8713099], [40.863743499999998, -73.862489299999993], [40.726060100000005, -73.978595200000001], [40.556795100000002, -74.173905700000006], [40.596731200000001, -74.070423200000008], [40.764357399999994, -73.923461900000007], [40.779668399999998, -73.921588799999995], [40.754115000000006, -73.786027599999997], [40.675582700000007, -73.785292200000001], [40.602195999999999, -74.0035709], [40.703277500000006, -74.017027900000016], [40.712217200000005, -74.016057599999982], [40.6261638, -74.032949900000006], [40.782882799999996, -73.780144700000008], [40.758556899999995, -73.765436700000009], [40.653682200000006, -73.956149499999995], [40.8700999, -73.885691199999997], [40.724370700000009, -73.715401400000005], [40.852319799999997, -73.886009999999999], [40.611269100000001, -73.997694600000003], [40.611269100000001, -73.997694600000003], [40.620814299999999, -74.188582499999995], [40.798895799999997, -73.969779500000001], [40.684868899999998, -73.984472200000013], [40.632300899999997, -73.988879699999998], [40.556494499999999, -73.926248299999997], [40.708949100000005, -73.815439400000002], [40.578070600000004, -73.959656499999994], [40.615833500000001, -73.821321299999994], [40.860489899999997, -73.87425309999999], [40.850655799999998, -73.866524099999992], [40.6960105, -73.993287199999997], [40.705174399999997, -73.971627099999992], [40.663080000000001, -73.909527900000015], [40.694428199999997, -73.921285800000007], [40.694428199999997, -73.921285800000007], [40.692157999999999, -73.733075299999996], [40.640232500000003, -73.906057900000008], [40.6795331, -73.999163699999997], [40.793474400000001, -73.921697099999989], [40.793474400000001, -73.921697099999989], [40.771132899999998, -73.974187400000005], [40.528196700000002, -74.235540400000005], [40.715750899999996, -73.997030699999996], [40.846820200000003, -73.787498299999996], [40.840046999999998, -73.903648700000005], [40.763758100000004, -73.991818100000003], [40.689366499999998, -73.963902099999999], [40.763758100000004, -73.991818100000003], [40.874969799999995, -73.828186500000001], [40.686535999999997, -73.996225499999994], [40.786394999999999, -73.838965700000003], [40.678101500000004, -74.006062400000005], [40.574926099999999, -73.985941400000016], [40.744985900000003, -73.864261299999995], [40.744985900000003, -73.864261299999995], [40.843053900000001, -73.821321299999994], [40.839113299999994, -73.892598300000003], [40.836655799999996, -73.892195900000004], [40.668103199999997, -73.944799400000008], [40.668103199999997, -73.944799400000008], [40.683611799999994, -73.880130100000002], [40.768712999999998, -73.747076500000006], [40.696019100000001, -73.984518000000008], [40.703316399999999, -73.988145099999983], [40.618718100000002, -74.015323099999989], [40.746500399999995, -74.001373700000002], [40.831676100000003, -73.9227554], [40.773750499999998, -73.8713099], [40.643747399999995, -73.930103700000004], [40.643747399999995, -73.930103700000004], [40.752558899999997, -73.809557400000003], [40.795739900000001, -73.938921300000004], [40.795739900000001, -73.938921300000004], [40.656831200000006, -73.883070099999983], [40.656831200000006, -73.883070099999983], [40.845378100000005, -73.890969299999995], [40.726477299999999, -73.9815337], [40.715876200000004, -73.933042900000004], [40.883324000000002, -73.827202900000003], [40.737974999999999, -73.880130100000002], [40.737974999999999, -73.880130100000002], [40.539446300000002, -74.156292000000008], [40.649632700000005, -73.952894000000001], [40.599893100000003, -73.744843700000004], [40.707490899999996, -74.011276400000014], [40.707490899999996, -74.011276400000014], [40.6409217, -73.962432700000008], [40.741060499999996, -73.989698599999997], [40.626843200000003, -73.933042900000004], [40.767498700000004, -73.833078999999998], [40.742805400000002, -73.844846900000007], [40.861465799999998, -73.890542500000009], [40.718105999999999, -73.844846900000007], [40.700022699999998, -73.85660870000001], [40.6920638, -73.974187400000005], [40.733517900000002, -73.780144700000008], [40.577455, -74.186123999999992], [40.754707200000006, -73.991634200000007], [40.747150399999995, -73.711822299999994], [40.698993999999999, -73.880442700000003], [40.689450100000002, -74.016792000000009], [40.699474799999997, -74.039558700000001], [40.690049500000001, -74.045067500000002], [40.673336399999997, -73.990348900000001], [40.737612100000007, -73.986091400000007], [40.591016600000003, -73.977125999999998], [40.554327299999997, -74.156292000000008], [40.550207299999997, -74.126932199999999], [40.659016999999999, -73.995692000000005], [40.724544799999997, -73.941860300000002], [40.733571900000001, -74.002741799999995], [40.733571900000001, -74.002741799999995], [40.614643200000003, -74.091694400000009], [40.825959699999999, -73.949607900000004], [40.587946500000001, -73.808086900000006], [40.580766299999993, -74.168034700000007], [40.8384699, -73.927164400000009], [40.843395899999997, -73.933242700000008], [40.721237200000004, -73.797792799999996], [40.711220300000001, -73.762495000000001], [40.594222600000002, -73.958371999999997], [40.657122200000003, -73.842998900000012], [40.726583399999996, -74.007473099999984], [40.812024600000001, -73.880130100000002], [40.867714500000005, -73.921201900000014], [40.871541700000002, -73.925694800000002], [40.755681799999998, -73.883070099999983], [40.702677000000001, -73.7889689], [40.717853900000001, -73.774261599999988], [40.641311100000003, -73.77813909999999], [40.637641500000001, -73.974187400000005], [40.705694999999999, -73.827202900000003], [40.738498600000007, -73.810685400000011], [40.873999799999993, -73.902728600000003], [40.7423292, -73.980064499999997], [40.776927100000002, -73.873965900000016], [40.674086100000004, -73.744843700000004], [40.767591499999995, -73.967556999999999], [40.767591499999995, -73.967556999999999], [40.773828000000002, -73.984472200000013], [40.773828000000002, -73.984472200000013], [40.719141299999997, -73.997327299999995], [40.744678999999998, -73.948542400000008], [40.744678999999998, -73.948542400000008], [40.824843799999996, -73.8915875], [40.715032999999998, -73.984272400000009], [40.605624900000002, -73.949207900000005], [40.578158000000002, -73.938921300000004], [40.802478999999998, -73.958684900000009], [40.816944299999996, -73.955833299999995], [40.876117299999997, -73.910262799999998], [40.611991100000004, -73.933042900000004], [40.611991100000004, -73.933042900000004], [40.633628700000003, -74.156292000000008], [40.729401799999998, -73.906588299999996], [40.740986499999998, -74.007610799999995], [40.820971899999996, -73.916876599999995], [40.717371999999997, -73.874250000000004], [40.755367600000007, -73.978413700000004], [40.754036900000003, -73.9668408], [40.754930899999998, -73.984019499999988], [40.754930899999998, -73.984019499999988], [40.619062899999996, -73.965371500000003], [40.8089564, -73.962432700000008], [40.825066299999996, -73.91099770000001], [40.809106799999995, -73.922888099999994], [40.848886299999997, -73.9051185], [40.7478792, -73.975656700000002], [40.766524500000003, -73.803675200000001], [40.573349299999997, -74.115187000000006], [40.750269799999998, -73.862489299999993], [40.8771463, -73.878660099999991], [40.7408584, -73.758240999999998], [40.558475099999995, -74.115187000000006], [40.613096200000008, -73.968653400000008], [40.642428199999998, -73.9736312], [40.733124100000005, -73.892725499999997], [40.679407200000007, -73.85072790000001], [40.668103799999997, -73.980581700000002], [40.838252200000007, -73.85660870000001], [40.849671399999998, -73.833084400000004], [40.861499999999999, -73.797200000000004], [40.855327899999999, -73.863959399999999], [40.750568000000001, -73.993518999999992], [40.635491399999999, -74.125464099999988], [40.659044799999997, -73.950677400000004], [40.6774196, -73.9668408], [40.660203700000004, -73.968955799999989], [40.715662799999997, -73.7419017], [40.750928700000003, -73.940357999999989], [40.756695299999997, -73.948402099999996], [40.793227100000003, -73.921285800000007], [40.677280200000006, -74.009447099999988], [40.725572200000002, -73.862489299999993], [40.695810799999997, -73.827202900000003], [40.704398600000005, -73.901829199999995], [40.793127699999999, -73.886009999999999], [40.894085299999993, -73.91099770000001], [40.579786299999995, -73.83722370000001], [40.760503100000001, -73.950993400000002], [40.658406799999995, -73.738959599999987], [40.550980799999998, -74.203258099999985], [40.6894086, -73.765436700000009], [40.642701700000003, -74.07994690000001], [40.728223900000003, -73.794851600000001], [40.834880900000002, -73.833084400000004], [40.710321999999998, -74.002550200000002], [40.597584699999999, -73.953616299999993], [40.723300999999999, -74.002988299999998], [40.825141100000003, -73.868369700000002], [40.825141100000003, -73.868369700000002], [40.582902399999995, -74.073863099999997], [40.680859399999996, -73.791910299999998], [40.676400299999997, -73.81249840000001], [40.708569200000007, -73.970196700000002], [40.662644100000001, -73.768378400000003], [40.662644100000001, -73.768378400000003], [40.881163700000002, -73.915406900000008], [40.628877799999998, -74.078478500000003], [40.7516034, -74.006518900000003], [40.7745459, -73.903747700000011], [40.731690299999997, -73.977849400000011], [40.688227900000001, -73.933098099999995], [40.743275899999993, -73.919632399999998], [40.645532000000003, -74.012385099999989], [40.645532000000003, -74.012385099999989], [40.757628100000005, -73.961697999999998], [40.759011000000001, -73.984472200000013], [40.716269200000006, -74.008632300000002], [40.710746899999997, -73.996960000000001], [40.783060299999995, -73.971248799999998], [40.735653999999997, -73.990381999999997], [40.859586100000001, -73.91099770000001], [40.773564899999997, -73.956555100000003], [40.773564899999997, -73.956555100000003], [40.787010600000002, -73.975367599999998], [40.787010600000002, -73.975367599999998], [40.897934599999999, -73.88595140000001], [40.884307, -73.89355479999999], [40.845888799999997, -73.866899599999996], [40.841708200000006, -73.939355399999997], [40.841708200000006, -73.939355399999997], [40.627029799999995, -74.109314099999992], [40.746500399999995, -74.001373700000002], [40.831676100000003, -73.9227554], [40.843060899999998, -73.8816001], [40.735781000000003, -74.0035709], [40.830965300000003, -73.869547400000002], [40.616296000000006, -74.138676700000005], [40.792044899999993, -73.809557400000003], [40.760691100000003, -73.840435999999997], [40.877685900000003, -73.85660870000001], [40.719401599999998, -73.963999999999999], [40.707993600000002, -73.951733500000003], [40.653934599999999, -73.975656700000002], [40.690136600000002, -73.85660870000001], [40.895361000000001, -73.862915999999998], [40.751212299999999, -73.903648700000005], [40.711801100000002, -74.013119599999996], [40.776223100000003, -73.949207900000005], [40.776223100000003, -73.949207900000005], [40.508971200000005, -74.212685300000004], [40.508971200000005, -74.212685300000004]])

#location_ID = np.array(location_data.iloc[:, 4:6])
#np.save('ID_list', location_ID)
#location_ID = np.load('ID_list.npy')
#location_ID_2 = np.zeros((location_ID.shape[0]+1, 2))
#location_ID_2[1:, :] = location_ID
#np.save('ID_list_2', location_ID_2)
#np.save('location_list', location_list)
#location_data = pd.read_csv('Zone_location.csv')

data = pd.read_csv('yellow_tripdata_2015-06.csv')
location_list = np.array(data.iloc[:, 5:7]) 

location_ID = np.load('ID_list.npy')
location_list = np.load('location_list.npy')

def find_id(location, LOC = location_ID):
	distance2id = np.linalg.norm(LOC - location, axis = 1)
	ID = np.argmin(distance2id)
	return ID

ID_list = map(find_id, location_list)
np.save('ID_list_final', ID_list)


ID_list_final = np.load('ID_list_final.npy')
data['location_ID'] = pd.Series(ID_list_final)
data.to_csv('yellow_tripdata_2015-06.csv')

